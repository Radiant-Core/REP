# REP-3013: Glyph Containers and Collections

| Field | Value |
|-------|-------|
| REP | 3013 |
| Title | Glyph Containers and Collections |
| Author | Radiant Community |
| Status | Draft |
| Type | Standards Track |
| Category | Token Standard |
| Created | 2026-01-25 |
| Requires | REP-3001, REP-3002 |

---

## Abstract

This REP defines `GLYPH_CONTAINER` (protocol ID 7), a mechanism for grouping multiple Glyph tokens into hierarchical collections. Containers enable NFT collections, media albums, asset bundles, and other groupings with shared metadata, unified management, and efficient indexing.

---

## Motivation

Many token use cases require grouping related assets:

1. **NFT Collections**: 10,000 PFP avatars from the same artist
2. **Media Albums**: Songs belonging to an album
3. **Game Asset Bundles**: Starter pack with multiple items
4. **Document Sets**: Related files grouped together
5. **Series Releases**: Sequential drops from a creator

Without a standard container mechanism:
- Each project invents its own grouping system
- Indexers cannot efficiently query collections
- Wallets display unrelated items separately
- Collection-level metadata is scattered

`GLYPH_CONTAINER` provides a unified standard for hierarchical token organization.

---

## Specification

### 1. Protocol Identifier

```
GLYPH_CONTAINER = 7
```

A container is a Glyph with protocol ID 7 in its `p` array:
```json
{ "p": [2, 7] }  // NFT + Container
```

### 2. Container Types

| Type | Description | Use Case |
|------|-------------|----------|
| `collection` | Numbered NFT collection | PFP projects, art series |
| `album` | Media collection | Music albums, photo sets |
| `bundle` | Packaged assets | Starter packs, gift boxes |
| `series` | Sequential releases | Episodes, chapters |
| `folder` | Generic grouping | Document organization |

### 3. Container Metadata Schema

#### 3.1 Root Object

```json
{
  "v": 2,
  "type": "container",
  "p": [2, 7],
  "name": "My Collection",
  "desc": "A curated collection of unique digital art",
  "container": {
    "type": "collection",
    "max_items": 10000,
    "minted": 0,
    "open": true,
    "items": [],
    "traits": { ... },
    "stats": { ... }
  },
  "content": { ... },
  "preview": { ... },
  "royalty": { ... }
}
```

#### 3.2 Container Object Fields

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `type` | string | Yes | - | Container type (see Â§2) |
| `max_items` | integer | No | null | Maximum items (null = unlimited) |
| `minted` | integer | No | 0 | Current item count |
| `open` | boolean | No | true | Can new items be added |
| `items` | array | No | [] | Child item references (inline or paginated) |
| `traits` | object | No | {} | Collection-wide trait definitions |
| `stats` | object | No | {} | Collection statistics |
| `ordering` | string | No | "index" | Item ordering (index, alpha, custom) |

#### 3.3 Traits Definition

For NFT collections with attributes:

```json
{
  "container": {
    "traits": {
      "Background": {
        "type": "string",
        "values": ["Red", "Blue", "Green", "Gold"],
        "distribution": { "Red": 40, "Blue": 30, "Green": 25, "Gold": 5 }
      },
      "Rarity": {
        "type": "string",
        "values": ["Common", "Rare", "Legendary"]
      },
      "Power": {
        "type": "number",
        "min": 1,
        "max": 100
      }
    }
  }
}
```

#### 3.4 Collection Stats

```json
{
  "container": {
    "stats": {
      "total_volume": 1000000000,
      "floor_price": 50000,
      "unique_owners": 2500,
      "listed_count": 150
    }
  }
}
```

### 4. Child Item Reference

#### 4.1 Relationship from Child to Container

Child tokens reference their parent container:

```json
{
  "v": 2,
  "type": "nft",
  "p": [2],
  "name": "Collection Item #42",
  "rels": {
    "container": {
      "ref": "<container_token_ref>",
      "index": 42
    }
  },
  "attrs": {
    "Background": "Gold",
    "Rarity": "Legendary",
    "Power": 95
  }
}
```

#### 4.2 Relationship Fields

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `ref` | string | Yes | Container token reference |
| `index` | integer | No | Position in collection (1-based) |
| `series` | string | No | Series/season identifier |
| `edition` | string | No | Edition label |

#### 4.3 Inline Items Array

For small collections, items can be listed inline:

```json
{
  "container": {
    "items": [
      { "ref": "<item1_ref>", "index": 1 },
      { "ref": "<item2_ref>", "index": 2 },
      { "ref": "<item3_ref>", "index": 3 }
    ]
  }
}
```

For large collections, use indexer queries instead.

### 5. Container Lifecycle

#### 5.1 Creation

1. Create container token with `GLYPH_CONTAINER` protocol
2. Set `container.type` and initial configuration
3. Container is now ready to receive items

#### 5.2 Adding Items

Items are added by creating child tokens with `rels.container`:

```json
{
  "rels": {
    "container": {
      "ref": "<container_ref>",
      "index": 42
    }
  }
}
```

The container itself is NOT modified when items are added (unless using `GLYPH_MUT` for minted counter).

#### 5.3 Mutable Container State

For tracking `minted` count on-chain:

```json
{
  "p": [2, 5, 7],  // NFT + Mutable + Container
  "mutable": {
    "allowed": true,
    "controller": "<controller_ref>",
    "fields": ["/container/minted", "/container/stats"]
  }
}
```

#### 5.4 Closing a Container

Set `container.open: false` to prevent new items:

```json
{
  "container": {
    "open": false,
    "max_items": 100,
    "minted": 100
  }
}
```

### 6. Container Authority

#### 6.1 Creator Authority

The container creator can:
- Update container metadata (if mutable)
- Add official items to the collection
- Close the container
- Update collection-level royalties

#### 6.2 Third-Party Items

By default, anyone can create items referencing a container. To restrict:

```json
{
  "container": {
    "authority": {
      "restricted": true,
      "authorized": ["<creator_pubkey>", "<collaborator_pubkey>"]
    }
  }
}
```

Indexers SHOULD flag unauthorized items.

### 7. Indexer Requirements

#### 7.1 Container Indexing

Indexers MUST:
1. Recognize `GLYPH_CONTAINER` protocol ID
2. Parse `container` metadata object
3. Index `rels.container` relationships
4. Build container â†’ items mapping
5. Track container statistics

#### 7.2 Query Endpoints

```
GET /containers                        â€” List all containers
GET /containers/:ref                   â€” Get container details
GET /containers/:ref/items             â€” List items in container
GET /containers/:ref/items?page=2      â€” Paginated items
GET /containers/:ref/stats             â€” Collection statistics
GET /containers/:ref/traits            â€” Trait definitions
GET /containers/:ref/traits/:name      â€” Trait value distribution
GET /tokens/:ref/container             â€” Get container for item
```

#### 7.3 Response Format

```json
{
  "container": {
    "ref": "abc123...",
    "name": "My Collection",
    "type": "collection",
    "max_items": 10000,
    "minted": 5000,
    "floor_price": 50000,
    "total_volume": 1000000000
  },
  "items": [
    { "ref": "item1...", "index": 1, "name": "Item #1" },
    { "ref": "item2...", "index": 2, "name": "Item #2" }
  ],
  "pagination": {
    "page": 1,
    "per_page": 100,
    "total": 5000
  }
}
```

### 8. Wallet Implementation

#### 8.1 Display Requirements

Wallets SHOULD:
- Group items by container in portfolio view
- Show container thumbnail and name
- Display item count and collection stats
- Link to container from item detail view

#### 8.2 Collection View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ–¼ï¸ My Collection                                        â”‚
â”‚  5,000 / 10,000 minted                                  â”‚
â”‚  Floor: 50,000 photons | Volume: 1B photons             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Item #1] [Item #2] [Item #3] [Item #4] [Item #5] ...  â”‚
â”‚  [Item #6] [Item #7] [Item #8] [Item #9] [Item #10] ... â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9. Container Types Detail

#### 9.1 Collection

Standard NFT collection with numbered items:

```json
{
  "container": {
    "type": "collection",
    "max_items": 10000,
    "traits": {
      "Background": { "type": "string", "values": [...] }
    }
  }
}
```

#### 9.2 Album

Media collection (music, photos, videos):

```json
{
  "container": {
    "type": "album",
    "ordering": "track",
    "duration": 3600,
    "tracks": 12
  }
}
```

Child items include track metadata:
```json
{
  "rels": {
    "container": { "ref": "...", "index": 3 }
  },
  "app": {
    "data": {
      "track_number": 3,
      "duration": 240,
      "bpm": 120
    }
  }
}
```

#### 9.3 Bundle

Package of related assets sold/transferred together:

```json
{
  "container": {
    "type": "bundle",
    "transferable": "together",
    "price": 100000
  }
}
```

Bundle items may be configured for atomic transfer.

#### 9.4 Series

Sequential releases over time:

```json
{
  "container": {
    "type": "series",
    "seasons": [
      { "id": "S1", "name": "Season 1", "episodes": 10 },
      { "id": "S2", "name": "Season 2", "episodes": 12 }
    ]
  }
}
```

Child items include series metadata:
```json
{
  "rels": {
    "container": { "ref": "...", "series": "S1", "index": 5 }
  }
}
```

### 10. Nested Containers

Containers can reference parent containers for hierarchical organization:

```json
{
  "v": 2,
  "type": "container",
  "p": [2, 7],
  "name": "Season 2",
  "rels": {
    "container": {
      "ref": "<main_series_container>",
      "index": 2
    }
  },
  "container": {
    "type": "series",
    "max_items": 12
  }
}
```

This creates:
```
Main Series (container)
â”œâ”€â”€ Season 1 (container)
â”‚   â”œâ”€â”€ Episode 1 (item)
â”‚   â”œâ”€â”€ Episode 2 (item)
â”‚   â””â”€â”€ ...
â”œâ”€â”€ Season 2 (container)
â”‚   â”œâ”€â”€ Episode 1 (item)
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

### 11. Examples

#### 11.1 PFP Collection

**Container**:
```json
{
  "v": 2,
  "type": "container",
  "p": [2, 7],
  "name": "Radiant Punks",
  "desc": "10,000 unique punks on Radiant",
  "container": {
    "type": "collection",
    "max_items": 10000,
    "minted": 10000,
    "open": false,
    "traits": {
      "Type": { "type": "string", "values": ["Human", "Ape", "Zombie", "Alien"] },
      "Accessory": { "type": "string", "values": ["None", "Earring", "Pipe", "Mohawk"] }
    }
  },
  "preview": {
    "thumb": { "path": "banner.png", "mime": "image/png" }
  },
  "royalty": {
    "enforced": true,
    "bps": 500,
    "address": "1CreatorAddress..."
  }
}
```

**Item**:
```json
{
  "v": 2,
  "type": "nft",
  "p": [2],
  "name": "Radiant Punk #42",
  "rels": {
    "container": {
      "ref": "<punks_container_ref>",
      "index": 42
    }
  },
  "attrs": {
    "Type": "Alien",
    "Accessory": "Pipe"
  },
  "content": {
    "primary": { "path": "punk42.png", "mime": "image/png" }
  }
}
```

#### 11.2 Music Album

**Container**:
```json
{
  "v": 2,
  "type": "container",
  "p": [2, 7],
  "name": "Blockchain Dreams",
  "desc": "An album exploring the intersection of music and crypto",
  "container": {
    "type": "album",
    "tracks": 10,
    "duration": 2700
  },
  "content": {
    "cover": { "path": "album-cover.jpg", "mime": "image/jpeg" }
  }
}
```

**Track Item**:
```json
{
  "v": 2,
  "type": "nft",
  "p": [2],
  "name": "Track 3: Consensus",
  "rels": {
    "container": { "ref": "<album_ref>", "index": 3 }
  },
  "app": {
    "namespace": "rxd.music",
    "data": {
      "track_number": 3,
      "duration": 245,
      "bpm": 128,
      "key": "Am"
    }
  },
  "content": {
    "primary": { "path": "track03.mp3", "mime": "audio/mpeg" }
  }
}
```

### 12. Security Considerations

#### 12.1 Unauthorized Items

Anyone can create items claiming membership in a container. Mitigations:
- `authority.restricted` flag for gated collections
- Indexers flag unauthorized items
- Wallets show verification status

#### 12.2 Container Reference Validation

Indexers MUST verify:
- Referenced container exists
- Container ref format is valid
- Index doesn't exceed `max_items`

#### 12.3 Statistics Manipulation

On-chain stats can be manipulated via wash trading. Indexers SHOULD:
- Calculate stats independently
- Use heuristics to detect manipulation
- Clearly label self-reported vs calculated stats

### 13. Backwards Compatibility

- Tokens without `rels.container` are standalone items
- v1 tokens cannot be container children (no `rels` field)
- Containers are regular NFTs, displayable in v1 wallets
- Container features require v2-compatible indexers

---

## Test Vectors

### Vector 1: Container Creation

**Metadata**:
```json
{
  "v": 2,
  "type": "container",
  "p": [2, 7],
  "name": "Test Collection",
  "container": {
    "type": "collection",
    "max_items": 100
  }
}
```

**Expected protocol array**: `[2, 7]`

### Vector 2: Child Item

**Metadata**:
```json
{
  "v": 2,
  "type": "nft",
  "p": [2],
  "name": "Item #1",
  "rels": {
    "container": {
      "ref": "abc123def456...",
      "index": 1
    }
  }
}
```

**Expected `rels.container.ref`**: 36-byte token reference

---

## Rationale

### Why a Protocol ID Instead of Metadata Only?

- Enables efficient indexer filtering
- Clear signal for wallet UI treatment
- Consistent with other Glyph extensions

### Why Child â†’ Parent Reference Direction?

- Containers can have unlimited items without metadata bloat
- Items can be created without modifying container
- Parallel minting doesn't require coordination
- Simpler on-chain operations

### Why Optional Authority?

- Open containers enable community participation
- Closed containers enable verified collections
- Flexibility for different use cases

---

## References

1. "Glyph Protocol v2 Core," REP-3001
2. "Glyph v2 Envelope Formats," REP-3002
3. EIP-721: Non-Fungible Token Standard (Ethereum)
4. OpenSea Collection Standards

---

## Copyright

This REP is licensed under the MIT License.
