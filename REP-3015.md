# REP-3015: Glyph Authority Tokens

| Field | Value |
|-------|-------|
| REP | 3015 |
| Title | Glyph Authority Tokens |
| Author | Radiant Community |
| Status | Draft |
| Type | Standards Track |
| Category | Token Standard |
| Created | 2026-01-25 |
| Requires | REP-3001, REP-3002, REP-3013 |

---

## Abstract

This REP defines `GLYPH_AUTHORITY` (protocol ID 10), a token standard for representing transferable project authority, minting rights, and creator verification. Authority tokens enable transferable project ownership, multi-sig minting, revocable delegation, and verified creator badges within the Glyph v2 ecosystem.

---

## Motivation

Current Glyph mechanisms handle token-level permissions:
- `mutable.controller` authorizes updates to a specific token
- `container.authority` controls who can add items to a collection

However, several use cases require **project-level** authority that is:

1. **Transferable**: Authority can be sold or transferred to new owners
2. **Composable**: Multiple authority holders can govern a project
3. **Revocable**: Temporary grants that can be withdrawn
4. **Verifiable**: On-chain proof of authorized issuer status

`GLYPH_AUTHORITY` addresses these needs by defining authority as a first-class token that can be held, transferred, and validated on-chain.

### Use Cases

| Use Case | Description |
|----------|-------------|
| **Transferable Project Ownership** | Sell/transfer the right to issue new tokens in a series |
| **Multi-Sig Minting** | Require multiple authority holders to approve new mints |
| **Revocable Delegation** | Grant temporary minting rights that can be revoked |
| **Verified Creator Badge** | Proof of being an authorized issuer for a project |
| **Franchise Rights** | License others to create tokens under your brand |
| **DAO Governance** | Token-gated project management |

---

## Specification

### 1. Protocol Identifier

```
GLYPH_AUTHORITY = 10
```

Authority tokens include protocol ID 10 in their `p` array:
```json
{ "p": [2, 10] }  // NFT + Authority
```

### 2. Authority Types

| Type | Description | Typical Use |
|------|-------------|-------------|
| `issuer` | Right to mint new tokens | Project ownership |
| `manager` | Right to manage existing tokens | Collection curation |
| `delegate` | Temporary/limited authority | Contractor access |
| `badge` | Verification only, no permissions | Creator verification |

### 3. Authority Metadata Schema

#### 3.1 Root Object

```json
{
  "v": 2,
  "type": "authority",
  "p": [2, 10],
  "name": "Project XYZ Issuer Authority",
  "desc": "Grants minting rights for Project XYZ collection",
  "authority": {
    "type": "issuer",
    "scope": {
      "project": "<project_identifier>",
      "containers": ["<container_ref_1>", "<container_ref_2>"],
      "token_types": ["nft", "ft"]
    },
    "permissions": ["mint", "update", "burn", "delegate"],
    "constraints": {
      "max_mints": 10000,
      "expires": null,
      "revocable": true,
      "transferable": true
    },
    "issuer": {
      "ref": "<issuer_authority_ref_or_null>",
      "pubkey": "<creator_pubkey>"
    }
  }
}
```

#### 3.2 Authority Object Fields

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `type` | string | Yes | Authority type (see Â§2) |
| `scope` | object | Yes | What this authority governs |
| `permissions` | array | Yes | Granted permissions |
| `constraints` | object | No | Limits on authority |
| `issuer` | object | Yes | Who granted this authority |

#### 3.3 Scope Object

| Field | Type | Description |
|-------|------|-------------|
| `project` | string | Project identifier or name |
| `containers` | array | Container refs this authority covers |
| `token_types` | array | Token types allowed (nft, ft, etc.) |
| `token_refs` | array | Specific token refs (for narrow scope) |

#### 3.4 Permissions Array

| Permission | Description |
|------------|-------------|
| `mint` | Create new tokens in scope |
| `update` | Modify mutable tokens in scope |
| `burn` | Burn tokens in scope |
| `delegate` | Issue sub-authorities |
| `revoke` | Revoke delegated authorities |
| `transfer` | Transfer authority to others |
| `manage` | Manage container settings |

#### 3.5 Constraints Object

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `max_mints` | integer | null | Maximum tokens this authority can mint |
| `mints_used` | integer | 0 | Mints already performed |
| `expires` | string | null | ISO8601 expiration timestamp |
| `expires_height` | integer | null | Block height expiration |
| `revocable` | boolean | true | Can issuer revoke this authority |
| `transferable` | boolean | true | Can holder transfer authority |
| `cooldown` | integer | 0 | Seconds between mints |

### 4. Authority Hierarchy

#### 4.1 Root Authority

The original project creator holds the **root authority**:

```json
{
  "authority": {
    "type": "issuer",
    "issuer": {
      "ref": null,
      "pubkey": "<creator_pubkey>"
    },
    "permissions": ["mint", "update", "burn", "delegate", "revoke"]
  }
}
```

`issuer.ref: null` indicates this is the root authority.

#### 4.2 Delegated Authority

Sub-authorities reference their parent:

```json
{
  "authority": {
    "type": "delegate",
    "issuer": {
      "ref": "<parent_authority_ref>",
      "pubkey": "<delegator_pubkey>"
    },
    "permissions": ["mint"],
    "constraints": {
      "max_mints": 100,
      "expires": "2027-01-01T00:00:00Z",
      "revocable": true
    }
  }
}
```

#### 4.3 Authority Chain Validation

Indexers MUST validate the authority chain:

```
Root Authority (issuer.ref = null, valid creator signature)
    â†“ delegates
Tier 1 Authority (issuer.ref = root, has 'delegate' permission)
    â†“ delegates  
Tier 2 Authority (issuer.ref = tier1, has 'delegate' permission)
    ...
```

**Validation rules**:
1. Root authority must have valid creator signature
2. Each delegation requires `delegate` permission in parent
3. Child permissions âŠ† parent permissions
4. Child constraints â‰¥ parent constraints (more restrictive)

### 5. Multi-Sig Authority

#### 5.1 Threshold Signing

For multi-sig minting, create an authority requiring multiple signatures:

```json
{
  "authority": {
    "type": "issuer",
    "multisig": {
      "threshold": 2,
      "signers": [
        { "pubkey": "<signer1_pubkey>", "weight": 1 },
        { "pubkey": "<signer2_pubkey>", "weight": 1 },
        { "pubkey": "<signer3_pubkey>", "weight": 1 }
      ]
    },
    "permissions": ["mint", "update"]
  }
}
```

#### 5.2 Weighted Voting

```json
{
  "multisig": {
    "threshold": 3,
    "signers": [
      { "pubkey": "<founder_pubkey>", "weight": 2 },
      { "pubkey": "<advisor1_pubkey>", "weight": 1 },
      { "pubkey": "<advisor2_pubkey>", "weight": 1 }
    ]
  }
}
```

Founder (weight 2) + any advisor (weight 1) = 3, meets threshold.

### 6. Revocation

#### 6.1 Revocation Mechanism

Authorities with `revocable: true` can be revoked by their issuer.

**Revocation transaction**:
```json
{
  "v": 2,
  "p": [10],
  "action": "revoke",
  "target": "<authority_ref_to_revoke>",
  "reason": "Contract ended",
  "auth": {
    "authority": "<issuer_authority_ref>",
    "sig": "<signature>"
  }
}
```

#### 6.2 Revocation Proof

Published as OP_RETURN:
```
OP_RETURN <MAGIC || V2 || REVOKE_PAYLOAD>
```

#### 6.3 Indexer Handling

Indexers MUST:
1. Track revocation transactions
2. Mark revoked authorities as invalid
3. Reject actions signed by revoked authorities
4. Cascade revocation to child authorities

### 7. Authority Usage

#### 7.1 Minting with Authority

When minting tokens under an authority, include authority proof:

```json
{
  "v": 2,
  "type": "nft",
  "p": [2],
  "name": "Collection Item #42",
  "rels": {
    "container": { "ref": "<container_ref>", "index": 42 },
    "authority": {
      "ref": "<authority_ref>",
      "sig": "<signature_over_mint_data>"
    }
  }
}
```

#### 7.2 Authority Validation Flow

```
1. Parse rels.authority.ref
2. Fetch authority token metadata
3. Verify authority is not revoked
4. Verify authority is not expired
5. Verify scope includes target container/type
6. Verify permissions include 'mint'
7. Verify signature matches authority holder
8. Verify constraints (max_mints, cooldown)
9. Accept or reject mint
```

#### 7.3 Container Integration

Containers can require authority for item addition:

```json
{
  "container": {
    "type": "collection",
    "authority": {
      "required": true,
      "accepted": ["<authority_ref_1>", "<authority_ref_2>"]
    }
  }
}
```

Only holders of accepted authorities can add items.

### 8. Verified Creator Badges

#### 8.1 Badge Authority

A badge provides verification without minting rights:

```json
{
  "v": 2,
  "type": "authority",
  "p": [2, 10],
  "name": "Verified Creator: Alice",
  "authority": {
    "type": "badge",
    "scope": {
      "project": "Alice's Art"
    },
    "permissions": [],
    "issuer": {
      "ref": null,
      "pubkey": "<alice_pubkey>"
    }
  },
  "content": {
    "primary": { "path": "badge.png", "mime": "image/png" }
  }
}
```

#### 8.2 Verification Display

Wallets SHOULD display verified status:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¨ Alice's Art Collection                              â”‚
â”‚  âœ“ Verified Creator                                     â”‚
â”‚  Authority: abc123... (valid, not revoked)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9. Transferable Project Ownership

#### 9.1 Ownership Transfer

Root authority can be transferred like any NFT:

```
Input:  Authority UTXO (owned by Alice)
Output: Authority UTXO (owned by Bob)
```

After transfer, Bob holds all project rights.

#### 9.2 Non-Transferable Authorities

For personal/non-transferable rights:

```json
{
  "authority": {
    "constraints": {
      "transferable": false
    }
  }
}
```

**Script enforcement**:
```
// Verify output goes to same address
OP_INPUTINDEX OP_UTXOBYTECODE
OP_0 OP_OUTPUTBYTECODE
OP_EQUAL OP_VERIFY
```

### 10. Indexer Requirements

#### 10.1 Authority Indexing

Indexers MUST:
1. Recognize `GLYPH_AUTHORITY` protocol ID
2. Parse authority metadata
3. Build authority hierarchy tree
4. Track revocations
5. Validate authority chains on mint
6. Track constraint usage (mints_used, etc.)

#### 10.2 Database Schema

```sql
CREATE TABLE authorities (
  ref BYTEA PRIMARY KEY,
  type VARCHAR(32) NOT NULL,
  project TEXT,
  permissions TEXT[],
  issuer_ref BYTEA,
  issuer_pubkey BYTEA,
  max_mints INTEGER,
  mints_used INTEGER DEFAULT 0,
  expires TIMESTAMP,
  revoked BOOLEAN DEFAULT FALSE,
  revoked_at TIMESTAMP,
  revoked_by BYTEA,
  transferable BOOLEAN DEFAULT TRUE,
  holder_address TEXT,
  created_height INTEGER,
  created_at TIMESTAMP
);

CREATE TABLE authority_containers (
  authority_ref BYTEA REFERENCES authorities(ref),
  container_ref BYTEA,
  PRIMARY KEY (authority_ref, container_ref)
);

CREATE TABLE authority_revocations (
  id SERIAL PRIMARY KEY,
  authority_ref BYTEA REFERENCES authorities(ref),
  revoked_by BYTEA,
  reason TEXT,
  txid BYTEA,
  height INTEGER,
  created_at TIMESTAMP
);

CREATE INDEX idx_auth_project ON authorities(project);
CREATE INDEX idx_auth_issuer ON authorities(issuer_ref);
CREATE INDEX idx_auth_holder ON authorities(holder_address);
```

#### 10.3 API Endpoints

```
GET /authorities                         â€” List all authorities
GET /authorities/:ref                    â€” Get authority details
GET /authorities/:ref/chain              â€” Get authority hierarchy
GET /authorities/:ref/delegations        â€” List sub-authorities
GET /authorities/:ref/usage              â€” Usage stats (mints, etc.)
GET /authorities/project/:name           â€” Authorities for project
GET /containers/:ref/authorities         â€” Accepted authorities
POST /authorities/validate               â€” Validate authority for action
```

### 11. Wallet Implementation

#### 11.1 Authority Display

Wallets SHOULD display authority tokens with special UI:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”‘ AUTHORITY TOKEN                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Project XYZ Issuer Authority                           â”‚
â”‚                                                         â”‚
â”‚  Type:        Issuer                                    â”‚
â”‚  Permissions: mint, update, delegate                    â”‚
â”‚  Scope:       Project XYZ Collection                    â”‚
â”‚  Constraints: Max 10,000 mints (5,234 used)             â”‚
â”‚  Expires:     Never                                     â”‚
â”‚  Transferable: Yes                                      â”‚
â”‚  Status:      âœ“ Valid                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 11.2 Minting with Authority

```
1. User selects "Mint New Token"
2. Wallet detects user holds relevant authority
3. Wallet shows authority details and remaining capacity
4. User fills in token metadata
5. Wallet constructs mint with authority signature
6. Sign and broadcast
```

#### 11.3 Delegation Flow

```
1. User selects authority token
2. User chooses "Delegate"
3. User specifies:
   - Recipient address
   - Permissions to grant (subset)
   - Constraints (max mints, expiry)
4. Wallet creates new authority token
5. Links to parent authority
6. Sign and broadcast
```

### 12. Examples

#### 12.1 Project Root Authority

```json
{
  "v": 2,
  "type": "authority",
  "p": [2, 10],
  "name": "Radiant Punks - Root Authority",
  "desc": "Full control over Radiant Punks project",
  "authority": {
    "type": "issuer",
    "scope": {
      "project": "Radiant Punks",
      "containers": ["<punks_container_ref>"],
      "token_types": ["nft"]
    },
    "permissions": ["mint", "update", "burn", "delegate", "revoke", "manage"],
    "constraints": {
      "max_mints": 10000,
      "transferable": true
    },
    "issuer": {
      "ref": null,
      "pubkey": "02abc123..."
    }
  }
}
```

#### 12.2 Limited Delegation

```json
{
  "v": 2,
  "type": "authority",
  "p": [2, 10],
  "name": "Radiant Punks - Minter #1",
  "desc": "Limited minting rights for partner",
  "authority": {
    "type": "delegate",
    "scope": {
      "project": "Radiant Punks",
      "containers": ["<punks_container_ref>"]
    },
    "permissions": ["mint"],
    "constraints": {
      "max_mints": 500,
      "expires": "2026-12-31T23:59:59Z",
      "revocable": true,
      "transferable": false
    },
    "issuer": {
      "ref": "<root_authority_ref>",
      "pubkey": "02abc123..."
    }
  }
}
```

#### 12.3 Multi-Sig DAO Authority

```json
{
  "v": 2,
  "type": "authority",
  "p": [2, 10],
  "name": "Project DAO Authority",
  "authority": {
    "type": "issuer",
    "scope": {
      "project": "Community Project"
    },
    "permissions": ["mint", "update", "delegate"],
    "multisig": {
      "threshold": 3,
      "signers": [
        { "pubkey": "<member1>", "weight": 1, "label": "Alice" },
        { "pubkey": "<member2>", "weight": 1, "label": "Bob" },
        { "pubkey": "<member3>", "weight": 1, "label": "Carol" },
        { "pubkey": "<member4>", "weight": 1, "label": "Dave" },
        { "pubkey": "<member5>", "weight": 1, "label": "Eve" }
      ]
    },
    "issuer": {
      "ref": null,
      "pubkey": null
    }
  }
}
```

Any 3 of 5 members can authorize actions.

#### 12.4 Creator Badge

```json
{
  "v": 2,
  "type": "authority",
  "p": [2, 10],
  "name": "Verified Artist: @alice",
  "authority": {
    "type": "badge",
    "scope": {
      "project": "alice.wave"
    },
    "permissions": [],
    "constraints": {
      "transferable": false
    },
    "issuer": {
      "ref": null,
      "pubkey": "<alice_pubkey>"
    }
  },
  "content": {
    "primary": {
      "path": "verified-badge.svg",
      "mime": "image/svg+xml"
    }
  }
}
```

### 13. Security Considerations

#### 13.1 Authority Theft

Risk: Attacker steals authority token.

Mitigation:
- Use multi-sig for high-value authorities
- Set `transferable: false` for personal authorities
- Use hardware wallets for authority keys
- Monitor authority usage

#### 13.2 Delegation Abuse

Risk: Delegate exceeds intended scope.

Mitigation:
- Set explicit constraints (max_mints, expiry)
- Enable revocation
- Monitor delegate activity
- Use narrow scope definitions

#### 13.3 Revocation Failures

Risk: Revoked authority still being honored.

Mitigation:
- Indexers must track revocations in real-time
- Revocation cascades to children
- Wallets should check revocation status
- Mints should verify authority at time of inclusion

#### 13.4 Chain Validation Complexity

Risk: Deep authority chains are expensive to validate.

Mitigation:
- Recommend max depth of 5 levels
- Indexers cache chain validity
- Validate at mint time, not query time

### 14. Backwards Compatibility

- Tokens minted without authority are still valid
- Authority is opt-in for containers
- v1 tokens do not require authority
- Authority tokens are standard NFTs, displayable in v1 wallets

---

## Test Vectors

### Vector 1: Root Authority

**Metadata**:
```json
{
  "v": 2,
  "type": "authority",
  "p": [2, 10],
  "name": "Test Root Authority",
  "authority": {
    "type": "issuer",
    "scope": { "project": "Test" },
    "permissions": ["mint", "delegate"],
    "issuer": { "ref": null, "pubkey": "02aabbcc..." }
  }
}
```

**Expected**: Valid root authority (issuer.ref = null)

### Vector 2: Valid Delegation

**Parent permissions**: `["mint", "update", "delegate"]`
**Child permissions**: `["mint"]`

**Expected**: Valid (child âŠ† parent)

### Vector 3: Invalid Delegation

**Parent permissions**: `["mint"]`
**Child permissions**: `["mint", "delegate"]`

**Expected**: Invalid (`delegate` not in parent)

### Vector 4: Expired Authority

**Constraint**: `"expires": "2025-01-01T00:00:00Z"`
**Current time**: 2026-01-25

**Expected**: Authority invalid (expired)

---

## Rationale

### Why a Separate Token Type?

- Authority is a distinct concept from content NFTs
- Enables specialized indexer handling
- Clear UI treatment in wallets
- Composable with existing mechanisms

### Why Hierarchical Delegation?

- Mirrors real-world organizational structures
- Enables franchise/licensing models
- Supports revocation cascades
- Limits blast radius of compromised authorities

### Why Multi-Sig Support?

- Critical for DAOs and organizations
- Reduces single point of failure
- Enables governance structures
- Industry expectation for high-value assets

---

## References

1. "Glyph Protocol v2 Core," REP-3001
2. "Glyph v2 Envelope Formats," REP-3002
3. "Glyph Containers and Collections," REP-3013
4. BIP-340: Schnorr Signatures
5. BIP-174: Partially Signed Bitcoin Transactions (for multi-sig)

---

## Copyright

This REP is licensed under the MIT License.
